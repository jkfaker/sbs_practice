(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-login-login"],{"41b3":function(e,t,n){"use strict";n("6a54");var o=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n("2634")),c=o(n("2fdc"));n("c223");var r={data:function(){return{code:0,src:"",webviewStyles:{progress:{color:"#FF3333"}}}},methods:{getCode:function(){console.log("getCode");this.src="".concat(getApp().globalData.api).concat("/connect/oauth2/authorize","?response_type=code&state=").concat(1,"&scope=").concat("basic_info","&client_id=").concat(getApp().globalData.clientId,"&redirect_uri=").concat(encodeURIComponent(getApp().globalData.redirectUrl)),console.log(this.src)},getToken:function(e){var t=this;console.log("getToken"),uni.request({url:"".concat(getApp().globalData.URL).concat("/oauth/getToken","?code=").concat(e,"&redirect_uri=").concat(getApp().globalData.redirectUrl),method:"GET",header:{},success:function(e){var t=e.data.data;console.log("token:".concat(t)),uni.setStorageSync("token",t),uni.redirectTo({url:getApp().globalData.pagePath.login})},fail:function(e){console.log("token获取失败"),t.notify("error","网络异常！")}})},verify:function(){var e=this;return(0,c.default)((0,a.default)().mark((function t(){var n,o;return(0,a.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return"/teacher/login",console.log("token:".concat(uni.getStorageSync("token"))),t.next=4,uni.request({method:"POST",url:getApp().globalData.URL+"/teacher/login",header:{token:uni.getStorageSync("token")}});case 4:if(n=t.sent,console.log(n),o=n.data.code,console.log(o),1!==n.data.data){t.next=12;break}return console.log("教师端"),t.next=12,uni.reLaunch({url:getApp().globalData.pagePath.tIndex});case 12:if(2!==n.data.data){t.next=17;break}return console.log("学生端"),t.next=17,uni.reLaunch({url:getApp().globalData.pagePath.index});case 17:return console.log("登录失败"),e.notify("error",n.data.msg),t.abrupt("return");case 21:case"end":return t.stop()}}),t)})))()},notify:function(e,t){this.$refs.uNotify.show({top:10,type:e,message:t,duration:3e3,fontSize:20})}},onLoad:function(e){var t=this;return(0,c.default)((0,a.default)().mark((function n(){return(0,a.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.verify();case 2:console.log(e.code),e.code?t.getToken(e.code):t.getCode(),console.log(e.code),console.log(t.code);case 6:case"end":return n.stop()}}),n)})))()}};t.default=r},7379:function(e,t,n){"use strict";n.r(t);var o=n("86f1"),a=n("e5f9");for(var c in a)["default"].indexOf(c)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(c);var r=n("828b"),i=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"40460bea",null,!1,o["a"],void 0);t["default"]=i.exports},"86f1":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return o}));var o={uNotify:n("5916").default},a=function(){var e=this.$createElement,t=this._self._c||e;return t("v-uni-view",{staticClass:"container"},[t("u-notify",{ref:"uNotify"}),this.src?this._e():t("v-uni-view",{staticClass:"text"},[this._v("正在登录，请稍后...")]),this.src?t("v-uni-view",{staticClass:"web-view"},[t("v-uni-web-view",{attrs:{"webview-styles":this.webviewStyles,src:this.src}})],1):this._e()],1)},c=[]},e5f9:function(e,t,n){"use strict";n.r(t);var o=n("41b3"),a=n.n(o);for(var c in o)["default"].indexOf(c)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(c);t["default"]=a.a}}]);