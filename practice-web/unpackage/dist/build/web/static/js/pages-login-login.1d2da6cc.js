(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-login-login"],{"0e76":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o}));var o={uNotify:n("5916").default},a=function(){var e=this.$createElement,t=this._self._c||e;return t("v-uni-view",{staticClass:"container"},[t("u-notify",{ref:"uNotify"}),this.src?this._e():t("v-uni-view",{staticClass:"text"},[this._v("正在登录，请稍后...")]),this.src?t("v-uni-view",{staticClass:"web-view"},[t("v-uni-web-view",{attrs:{"webview-styles":this.webviewStyles,src:this.src}})],1):this._e()],1)},r=[]},"41b3":function(e,t,n){"use strict";n("6a54");var o=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("c223");var a=o(n("2634")),r=o(n("2fdc")),c={data:function(){return{code:0,src:"",webviewStyles:{progress:{color:"#FF3333"}}}},onLoad:function(e){var t=this;return(0,r.default)((0,a.default)().mark((function n(){return(0,a.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.verify();case 2:if(console.log(e.code),!e.code){n.next=8;break}return n.next=6,t.getToken(e.code);case 6:n.next=9;break;case 8:t.getCode();case 9:console.log(e.code),console.log(t.code);case 11:case"end":return n.stop()}}),n)})))()},methods:{getCode:function(){console.log("getCode");this.src="".concat(getApp().globalData.api).concat("/connect/oauth2/authorize","?response_type=code&state=").concat(1,"&scope=").concat("basic_info","&client_id=").concat(getApp().globalData.clientId,"&redirect_uri=").concat(encodeURIComponent(getApp().globalData.redirectUrl)),console.log(this.src)},getToken:function(e){var t=this;return(0,r.default)((0,a.default)().mark((function n(){var o,r;return(0,a.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return"/oauth/token",console.log("getToken"),n.next=4,uni.request({url:"".concat(getApp().globalData.URL).concat("/oauth/token","?code=").concat(e,"&redirect_uri=").concat(getApp().globalData.redirectUrl),method:"GET",header:{}});case 4:if(o=n.sent,0!==o.data.code){n.next=9;break}return console.log("token获取失败"),t.notify("error",o.data.msg),n.abrupt("return");case 9:return r=o.data.data,console.log("token:".concat(r)),n.next=13,uni.setStorageSync("token",r);case 13:return n.next=15,t.verify();case 15:case"end":return n.stop()}}),n)})))()},verify:function(){return(0,r.default)((0,a.default)().mark((function e(){var t,n;return(0,a.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return"/teacher/info/login",console.log("token:".concat(uni.getStorageSync("token"))),e.next=4,uni.request({method:"POST",url:getApp().globalData.URL+"/teacher/info/login",header:{token:uni.getStorageSync("token")}});case 4:return t=e.sent,console.log(t),n=t.data.code,console.log(n),1===t.data.data&&(console.log("教师端"),uni.reLaunch({url:getApp().globalData.pagePath.tIndex})),2===t.data.data&&(console.log("学生端"),uni.reLaunch({url:getApp().globalData.pagePath.index})),e.abrupt("return");case 13:case"end":return e.stop()}}),e)})))()},notify:function(e,t){this.$refs.uNotify.show({top:10,type:e,message:t,duration:3e3,fontSize:20})}}};t.default=c},7379:function(e,t,n){"use strict";n.r(t);var o=n("0e76"),a=n("e5f9");for(var r in a)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(r);var c=n("828b"),i=Object(c["a"])(a["default"],o["b"],o["c"],!1,null,"7f530e9e",null,!1,o["a"],void 0);t["default"]=i.exports},e5f9:function(e,t,n){"use strict";n.r(t);var o=n("41b3"),a=n.n(o);for(var r in o)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(r);t["default"]=a.a}}]);